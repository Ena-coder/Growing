### 如果一个alert可以解决的问题，那就请考虑一下定时器的延时功效吧！false，
> 事情是这样的😢：
> ![](https://user-gold-cdn.xitu.io/2020/5/21/17234f6eadf04455?w=436&h=931&f=png&s=152306)
> 在ios中（在安卓系统正常）这个loading条到最后就一直不动，一开始猜想是不是有什么内容一直没加载出来。
> 当在真机重现问题的时候发现，当再次进入页面时，进度条就能正常加载？于是对比第一次进入页面和再次进入页面调用的接口有什么不同，发现第一次访问时比第二次访问时多调用了这两个接口🤔：
> ![](https://user-gold-cdn.xitu.io/2020/5/21/17234fa30e638e1a?w=859&h=286&f=png&s=67476)
1. /portal/wxqyhLoginCtrl/weixinLogin.do
2. /portal/weixin/weixinclientAction!handleOauthCode.action

>接口1是我们代码有的，接口2是微信自带的，我们看不到代码，所以我们就去看看接口1的代码。

>发现拿到接口getUserInfo.do返回的数据response后，就根据response.data.isLogin进行判断，为false则调用接口weixinLogin.do实现当前页面打开指定URL页面，如果为true，则进入else分支...

>正理不到头绪的时候，本来想看看response.data.isLogin打印出来的是不是`false`，所以加了一个alert(response.data.isLogin)
```JavaScript
axios({
      method: 'post',
      url: baseURL + '/portal/wxqyhLoginCtrl/getUserInfo.do?corp_id=' + corp_id + '&agentCode=' + agentCode
    })//调用接口getUserInfo.do返回的数据response中的data.isLogin = false
      .then(function (response) {
        if (response.code == "0") {
            //加了下面这句话，看看response.data.isLogin打印出来的是不是false
            alert(response.data.isLogin)
          if (response.data.isLogin == false) {
            window.location.href = baseURL + "/portal/wxqyhLoginCtrl/weixinLogin.do?corp_id=" + corp_id + '&agentCode=' + agentCode + '&pre=' + encodeURIComponent(window.location.hash);
          } else {
            window.location.href.indexOf("%")!=-1? history.replaceState(null,"",decodeURIComponent(window.location.href)):"";
            wxqyhConfig(response, resolve);
          }
        } else { //登录接口访问不到
          window.location.href = '../module/error.html#/?msg=500NoResponse';
        }
      })
```
>结果竟发生了奇迹般的现象🤔，第一次访问的时候页面弹出了false，当点击确定后页面又能正常加载

>这个大转变给了我们一个思路
>只要给他一点时间，它就能再次访问，当第二次访问就不会加载这个接口，就能正常显示。
>只要给他一点时间，只要一点时间就够了。于是想到加一个定时器让它能够延时setTimeout(() => {})
```
if (response.data.isLogin == false) {
    setTimeout(() => {
      window.location.href = baseURL + "/portal/wxqyhLoginCtrl/weixinLogin.do?corp_id=" + corp_id + '&agentCode=' + agentCode + '&pre=' + encodeURIComponent(window.location.hash) + '&_t=' + new Date().getTime();
    },500)
} 
```

### 如何安装
[Charles证书装不上-android](https://www.jianshu.com/p/e60cd3c5cbb2)